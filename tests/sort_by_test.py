import sys

sys.path.append(".")
sys.path.append("../")
from main import sort_by
import pytest


@pytest.mark.parametrize(
    "dataframe, column, ascending, expected",
    [
        (
            {
                "index": [0, 1, 2, 3, 4, 5],
                "country": ["Spain", "Spain", "Spain", "Mexico", "Mexico", "Indonesia"],
                "year": ["2023", "2022", "2021", "2023", "2021", "2023"],
                "gdp": ["1394", "1409", "1425", "1490", "1274", "1319"],
                "gdp_growth": ["2.4", "5.5", "6.4", "3.2", "5.7", "5.0"],
                "inflation": ["3.2", "8.4", "3.0", "4.7", "5.7", "3.0"],
                "unemployment": ["11.8", "13.0", "14.8", "2.9", "4.1", "5.3"],
                "population": ["48", "48", "47", "128", "126", "278"],
                "continent": [
                    "Europe",
                    "Europe",
                    "Europe",
                    "North America",
                    "North America",
                    "Asia",
                ],
            },
            "gdp",
            False,
            {
                "index": [3, 2, 1, 0, 5, 4],
                "country": ["Mexico", "Spain", "Spain", "Spain", "Indonesia", "Mexico"],
                "year": ["2023", "2021", "2022", "2023", "2023", "2021"],
                "gdp": ["1490", "1425", "1409", "1394", "1319", "1274"],
                "gdp_growth": ["3.2", "6.4", "5.5", "2.4", "5.0", "5.7"],
                "inflation": ["4.7", "3.0", "8.4", "3.2", "3.0", "5.7"],
                "unemployment": ["2.9", "14.8", "13.0", "11.8", "5.3", "4.1"],
                "population": ["128", "47", "48", "48", "278", "126"],
                "continent": [
                    "North America",
                    "Europe",
                    "Europe",
                    "Europe",
                    "Asia",
                    "North America",
                ],
            },
        ),
        (
            {
                "index": [0, 1, 2, 3, 4, 5],
                "country": ["Spain", "Spain", "Spain", "Mexico", "Mexico", "Indonesia"],
                "year": ["2023", "2022", "2021", "2023", "2021", "2023"],
                "gdp": ["1394", "1409", "1425", "1490", "1274", "1319"],
                "gdp_growth": ["2.4", "5.5", "6.4", "3.2", "5.7", "5.0"],
                "inflation": ["3.2", "8.4", "3.0", "4.7", "5.7", "3.0"],
                "unemployment": ["11.8", "13.0", "14.8", "2.9", "4.1", "5.3"],
                "population": ["48", "48", "47", "128", "126", "278"],
                "continent": [
                    "Europe",
                    "Europe",
                    "Europe",
                    "North America",
                    "North America",
                    "Asia",
                ],
            },
            "gdp",
            True,
            {
                "index": [4, 5, 0, 1, 2, 3],
                "country": ["Mexico", "Indonesia", "Spain", "Spain", "Spain", "Mexico"],
                "year": ["2021", "2023", "2023", "2022", "2021", "2023"],
                "gdp": ["1274", "1319", "1394", "1409", "1425", "1490"],
                "gdp_growth": ["5.7", "5.0", "2.4", "5.5", "6.4", "3.2"],
                "inflation": ["5.7", "3.0", "3.2", "8.4", "3.0", "4.7"],
                "unemployment": ["4.1", "5.3", "11.8", "13.0", "14.8", "2.9"],
                "population": ["126", "278", "48", "48", "47", "128"],
                "continent": [
                    "North America",
                    "Asia",
                    "Europe",
                    "Europe",
                    "Europe",
                    "North America",
                ],
            },
        ),
        (
            {
                "index": [0, 1, 2, 3, 4, 5],
                "country": ["Spain", "Spain", "Spain", "Mexico", "Mexico", "Indonesia"],
                "year": ["2023", "2022", "2021", "2023", "2021", "2023"],
                "gdp": ["1394", "1409", "1425", "1490", "1274", "1319"],
                "gdp_growth": ["2.4", "5.5", "6.4", "3.2", "5.7", "5.0"],
                "inflation": ["3.2", "8.4", "3.0", "4.7", "5.7", "3.0"],
                "unemployment": ["11.8", "13.0", "14.8", "2.9", "4.1", "5.3"],
                "population": ["48", "48", "47", "128", "126", "278"],
                "continent": [
                    "Europe",
                    "Europe",
                    "Europe",
                    "North America",
                    "North America",
                    "Asia",
                ],
            },
            "gdp_growth",
            True,
            {
                "index": [0, 3, 5, 1, 4, 2],
                "country": ["Spain", "Mexico", "Indonesia", "Spain", "Mexico", "Spain"],
                "year": ["2023", "2023", "2023", "2022", "2021", "2021"],
                "gdp": ["1394", "1490", "1319", "1409", "1274", "1425"],
                "gdp_growth": ["2.4", "3.2", "5.0", "5.5", "5.7", "6.4"],
                "inflation": ["3.2", "4.7", "3.0", "8.4", "5.7", "3.0"],
                "unemployment": ["11.8", "2.9", "5.3", "13.0", "4.1", "14.8"],
                "population": ["48", "128", "278", "48", "126", "47"],
                "continent": [
                    "Europe",
                    "North America",
                    "Asia",
                    "Europe",
                    "North America",
                    "Europe",
                ],
            },
        ),
        (
            {
                "index": [0, 1, 2, 3, 4, 5],
                "country": ["Spain", "Spain", "Spain", "Mexico", "Mexico", "Indonesia"],
                "year": ["2023", "2022", "2021", "2023", "2021", "2023"],
                "gdp": ["1394", "1409", "1425", "1490", "1274", "1319"],
                "gdp_growth": ["2.4", "5.5", "6.4", "3.2", "5.7", "5.0"],
                "inflation": ["3.2", "8.4", "3.0", "4.7", "5.7", "3.0"],
                "unemployment": ["11.8", "13.0", "14.8", "2.9", "4.1", "5.3"],
                "population": ["48", "48", "47", "128", "126", "278"],
                "continent": [
                    "Europe",
                    "Europe",
                    "Europe",
                    "North America",
                    "North America",
                    "Asia",
                ],
            },
            "year",
            False,
            {
                "index": [0, 3, 5, 1, 2, 4],
                "country": ["Spain", "Mexico", "Indonesia", "Spain", "Spain", "Mexico"],
                "year": ["2023", "2023", "2023", "2022", "2021", "2021"],
                "gdp": ["1394", "1490", "1319", "1409", "1425", "1274"],
                "gdp_growth": ["2.4", "3.2", "5.0", "5.5", "6.4", "5.7"],
                "inflation": ["3.2", "4.7", "3.0", "8.4", "3.0", "5.7"],
                "unemployment": ["11.8", "2.9", "5.3", "13.0", "14.8", "4.1"],
                "population": ["48", "128", "278", "48", "47", "126"],
                "continent": [
                    "Europe",
                    "North America",
                    "Asia",
                    "Europe",
                    "Europe",
                    "North America",
                ],
            },
        ),
    ],
)
def test_sort_by(dataframe, column, ascending, expected):
    assert sort_by(dataframe=dataframe, column=column, ascending=ascending) == expected
